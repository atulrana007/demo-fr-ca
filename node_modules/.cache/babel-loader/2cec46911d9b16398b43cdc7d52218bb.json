{"ast":null,"code":"import _defineProperty from\"/home/raramuri/Videos/mcafee/language-test/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/raramuri/Videos/mcafee/language-test/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/raramuri/Videos/mcafee/language-test/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/raramuri/Videos/mcafee/language-test/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/raramuri/Videos/mcafee/language-test/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useCallback}from\"react\";import{debounce}from\"lodash\";import{AccountContext}from\"../providers/AccountContext\";import{AppContext}from\"../providers/AppContext\";import{CommonDataContext}from\"../providers/CommonDataContext\";import{validatePassword}from\"../validator/PasswordValidator\";export default function SignupContainer(props){var _useContext=useContext(AccountContext),SignupWithPassword=_useContext.SignupWithPassword,loginWithPassword=_useContext.loginWithPassword;var _useContext2=useContext(CommonDataContext),connections=_useContext2.connections;var _useContext3=useContext(AppContext),setWhichPage=_useContext3.setWhichPage;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loader=_useState2[0],setLoader=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isValid=_useState4[0],setIsValid=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),passwordRules=_useState6[0],setPasswordRules=_useState6[1];var _useState7=useState({email:\"\",password:\"\",confirmPassword:\"\",isSubmitting:false}),_useState8=_slicedToArray(_useState7,2),SignupForm=_useState8[0],setSignupForm=_useState8[1];var _useState9=useState({No_more_than_2_identical_characters_in_a_row:false,Special_characters:false,Lower_case_Upper_Case_Numbers:false,Length_Check:false,Non_empty_Password_Required:false}),_useState10=_slicedToArray(_useState9,2),PasswordPolicyState=_useState10[0],setPasswordPolicyState=_useState10[1];var _useState11=useState({email:\"\",isEmailError:\"\",databaseError:\"\",errorCode:\"\"}),_useState12=_slicedToArray(_useState11,2),SignupError=_useState12[0],setSignupError=_useState12[1];var debounceSubmit=useCallback(debounce(function(){setSignupForm(_objectSpread(_objectSpread({},SignupForm),{},{isSubmitting:false}));setIsValid(false);},2000),[]);var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setSignupForm(_objectSpread(_objectSpread({},SignupForm),{},{isSubmitting:true}));setLoader(true);_context.prev=3;_context.next=6;return SignupWithPassword(SignupForm.email,SignupForm.password);case 6:res=_context.sent;if(!res.email){_context.next=10;break;}_context.next=10;return loginWithPassword(SignupForm.email,SignupForm.password);case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](3);if(_context.t0.code===\"invalid_signup\"){setWhichPage(\"login-page\");}else{setSignupError(_objectSpread(_objectSpread({},SignupError),{},{databaseError:_context.t0.description,errorCode:_context.t0.code}));}case 15:setLoader(false);debounceSubmit();case 17:case\"end\":return _context.stop();}}},_callee,null,[[3,12]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var onClick=function onClick(e){setPasswordRules(connections[0]);};var onChange=function onChange(e){if(e.target.name===\"password\"&&passwordRules){validatePassword(passwordRules,e.target.value,PasswordPolicyState,setPasswordPolicyState,setIsValid);}setSignupForm(_objectSpread(_objectSpread({},SignupForm),{},_defineProperty({},e.target.name,e.target.value)));};var child=React.Children.only(props.children);return/*#__PURE__*/React.cloneElement(child,{onSubmit:onSubmit,SignupForm:SignupForm,onChange:onChange,onClick:onClick,passwordRules:passwordRules,PasswordPolicyState:PasswordPolicyState,isValid:isValid,SignupError:SignupError,loader:loader});}","map":{"version":3,"sources":["/home/raramuri/Videos/mcafee/language-test/src/containers/signupContainer.jsx"],"names":["React","useContext","useState","useCallback","debounce","AccountContext","AppContext","CommonDataContext","validatePassword","SignupContainer","props","SignupWithPassword","loginWithPassword","connections","setWhichPage","loader","setLoader","isValid","setIsValid","passwordRules","setPasswordRules","email","password","confirmPassword","isSubmitting","SignupForm","setSignupForm","No_more_than_2_identical_characters_in_a_row","Special_characters","Lower_case_Upper_Case_Numbers","Length_Check","Non_empty_Password_Required","PasswordPolicyState","setPasswordPolicyState","isEmailError","databaseError","errorCode","SignupError","setSignupError","debounceSubmit","onSubmit","e","preventDefault","res","code","description","onClick","onChange","target","name","value","child","Children","only","children","cloneElement"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useCallback } from \"react\";\nimport { debounce } from \"lodash\";\nimport { AccountContext } from \"../providers/AccountContext\";\nimport { AppContext } from \"../providers/AppContext\";\nimport { CommonDataContext } from \"../providers/CommonDataContext\";\nimport { validatePassword } from \"../validator/PasswordValidator\";\n\nexport default function SignupContainer(props) {\n  const { SignupWithPassword, loginWithPassword } = useContext(AccountContext);\n  const { connections } = useContext(CommonDataContext);\n  const { setWhichPage } = useContext(AppContext);\n  const [loader, setLoader] = useState(false);\n\n  const [isValid, setIsValid] = useState(false);\n  const [passwordRules, setPasswordRules] = useState(null);\n  const [SignupForm, setSignupForm] = useState({\n    email: \"\",\n    password: \"\",\n    confirmPassword: \"\",\n    isSubmitting: false,\n  });\n  const [PasswordPolicyState, setPasswordPolicyState] = useState({\n    No_more_than_2_identical_characters_in_a_row: false,\n    Special_characters: false,\n    Lower_case_Upper_Case_Numbers: false,\n    Length_Check: false,\n    Non_empty_Password_Required: false,\n  });\n  const [SignupError, setSignupError] = useState({\n    email: \"\",\n    isEmailError: \"\",\n    databaseError: \"\",\n    errorCode: \"\",\n  });\n\n  const debounceSubmit = useCallback(\n    debounce(() => {\n      setSignupForm({\n        ...SignupForm,\n        isSubmitting: false,\n      });\n      setIsValid(false);\n    }, 2000),\n    []\n  );\n\n  const onSubmit = async (e) => {\n    e.preventDefault();\n    setSignupForm({\n      ...SignupForm,\n      isSubmitting: true,\n    });\n    setLoader(true);\n    try {\n      const res = await SignupWithPassword(\n        SignupForm.email,\n        SignupForm.password\n      );\n      if (res.email) {\n        await loginWithPassword(SignupForm.email, SignupForm.password);\n      }\n    } catch (e) {\n      if (e.code === \"invalid_signup\") {\n        setWhichPage(\"login-page\");\n      } else {\n        setSignupError({\n          ...SignupError,\n          databaseError: e.description,\n          errorCode: e.code,\n        });\n      }\n    }\n    setLoader(false);\n    debounceSubmit();\n  };\n\n  const onClick = (e) => {\n    setPasswordRules(connections[0]);\n  };\n  const onChange = (e) => {\n    if (e.target.name === \"password\" && passwordRules) {\n      validatePassword(\n        passwordRules,\n        e.target.value,\n        PasswordPolicyState,\n        setPasswordPolicyState,\n        setIsValid\n      );\n    }\n    setSignupForm({\n      ...SignupForm,\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  const child = React.Children.only(props.children);\n  return React.cloneElement(child, {\n    onSubmit,\n    SignupForm,\n    onChange,\n    onClick,\n    passwordRules,\n    PasswordPolicyState,\n    isValid,\n    SignupError,\n    loader,\n  });\n}\n"]},"metadata":{},"sourceType":"module"}